SQL> SET AUTOTRACE ON EXPLAIN
SQL> SELECT DEPTNO, SUM(SAL)
  2  FROM EMP
  3  GROUP BY DEPTNO;

    DEPTNO   SUM(SAL)                                                                                                   
---------- ----------                                                                                                   
        30       9400                                                                                                   
        20      10875                                                                                                   
        10       8750                                                                                                   


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 4067220884                                                                                             
                                                                                                                        
---------------------------------------------------------------------------                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                             
---------------------------------------------------------------------------                                             
|   0 | SELECT STATEMENT   |      |     3 |    21 |     4  (25)| 00:00:01 |                                             
|   1 |  HASH GROUP BY     |      |     3 |    21 |     4  (25)| 00:00:01 |                                             
|   2 |   TABLE ACCESS FULL| EMP  |    14 |    98 |     3   (0)| 00:00:01 |                                             
---------------------------------------------------------------------------                                             

SQL> --GETTING DEPT WISE SALARIES AND OVERALL ORGANISATION SALARY
SQL> SELECT DEPTNO, SUM(SAL) DEPTSAL, E.TOTALSAL ORGSAL
  2  FROM EMP,
  3  		(SELECT SUM(SAL) TOTALSAL
  4  		FROM EMP
  5  		) E
  6  GROUP BY DEPTNO, E.ORGSAL
  7  ORDER BY DEPTNO;
GROUP BY DEPTNO, E.ORGSAL
                 *
ERROR at line 6:
ORA-00904: "E"."ORGSAL": invalid identifier 



SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, SUM(SAL) DEPTSAL, E.TOTALSAL
  2  FROM EMP,
  3  		(SELECT SUM(SAL) TOTALSAL
  4  		FROM EMP
  5  		) E
  6  GROUP BY DEPTNO, E.TOTALSAL
  7* ORDER BY DEPTNO
SQL> /

    DEPTNO    DEPTSAL   TOTALSAL                                                                                        
---------- ---------- ----------                                                                                        
        10       8750      29025                                                                                        
        20      10875      29025                                                                                        
        30       9400      29025                                                                                        


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 3709905072                                                                                             
                                                                                                                        
------------------------------------------------------------------------------                                          
| Id  | Operation             | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                          
------------------------------------------------------------------------------                                          
|   0 | SELECT STATEMENT      |      |     3 |    60 |     7  (15)| 00:00:01 |                                          
|   1 |  SORT GROUP BY        |      |     3 |    60 |     7  (15)| 00:00:01 |                                          
|   2 |   NESTED LOOPS        |      |    14 |   280 |     6   (0)| 00:00:01 |                                          
|   3 |    VIEW               |      |     1 |    13 |     3   (0)| 00:00:01 |                                          
|   4 |     SORT AGGREGATE    |      |     1 |     4 |            |          |                                          
|   5 |      TABLE ACCESS FULL| EMP  |    14 |    56 |     3   (0)| 00:00:01 |                                          
|   6 |    TABLE ACCESS FULL  | EMP  |    14 |    98 |     3   (0)| 00:00:01 |                                          
------------------------------------------------------------------------------                                          

SQL> -- IN ABOVE QUERY WE ARE HITTING THE TABLE TWICE, SO PERFORMANCE WISE NOT GOOD.
SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, SUM(SAL) DEPTSAL,
  2  		(SELECT SUM(SAL) 
  3  		FROM EMP
  4  		) TOTALSAL
  5  FROM EMP
  6  GROUP BY DEPTNO
  7* ORDER BY DEPTNO
SQL> /

    DEPTNO    DEPTSAL   TOTALSAL                                                                                        
---------- ---------- ----------                                                                                        
        10       8750      29025                                                                                        
        20      10875      29025                                                                                        
        30       9400      29025                                                                                        


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 870934053                                                                                              
                                                                                                                        
---------------------------------------------------------------------------                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                             
---------------------------------------------------------------------------                                             
|   0 | SELECT STATEMENT   |      |     3 |    21 |     4  (25)| 00:00:01 |                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                             
|   2 |   TABLE ACCESS FULL| EMP  |    14 |    56 |     3   (0)| 00:00:01 |                                             
|   3 |  SORT GROUP BY     |      |     3 |    21 |     4  (25)| 00:00:01 |                                             
|   4 |   TABLE ACCESS FULL| EMP  |    14 |    98 |     3   (0)| 00:00:01 |                                             
---------------------------------------------------------------------------                                             

SQL> --IN THIS CASE ALSO HITTING TABLE TWICE
SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, SUM(SAL) DEPTSAL
  2  FROM EMP
  3  GROUP BY DEPTNO
  4  UNION
  5  SELECT NULL, SUM(SAL) 
  6  FROM EMP
  7* ORDER BY DEPTNO
SQL> /

    DEPTNO    DEPTSAL                                                                                                   
---------- ----------                                                                                                   
        10       8750                                                                                                   
        20      10875                                                                                                   
        30       9400                                                                                                   
                29025                                                                                                   


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 768573151                                                                                              
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |     4 |    25 |    10  (40)| 00:00:01 |                                           
|   1 |  SORT UNIQUE         |      |     4 |    25 |     9  (67)| 00:00:01 |                                           
|   2 |   UNION-ALL          |      |       |       |            |          |                                           
|   3 |    HASH GROUP BY     |      |     3 |    21 |     5  (40)| 00:00:01 |                                           
|   4 |     TABLE ACCESS FULL| EMP  |    14 |    98 |     3   (0)| 00:00:01 |                                           
|   5 |    SORT AGGREGATE    |      |     1 |     4 |     4  (25)| 00:00:01 |                                           
|   6 |     TABLE ACCESS FULL| EMP  |    14 |    56 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> -- BY USING SET OPERATORS ALSO TABLE IS HITTING TWICE
SQL> --TO IMPROVE THE PERFORMANCE WE HAVE TO USE OLAP FUNCTION i.e., ROLLUP
SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, SUM(SAL) DEPTSAL
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO)
  4* ORDER BY DEPTNO
SQL> /

    DEPTNO    DEPTSAL                                                                                                   
---------- ----------                                                                                                   
        10       8750                                                                                                   
        20      10875                                                                                                   
        30       9400                                                                                                   
                29025                                                                                                   


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |     3 |    21 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |     3 |    21 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |    98 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> --BY USING OLAP FUNCTION ROLLUP, WE ARE HITTING THE TABLE ONLY ONCE.
SQL> --AND MEMORY OCCUPATION, COST, TIME IS LESS. SO OVERALL PERFORMANCE IS GOOD
SQL> --AND WHENEVER WE ARE GETTING THE GRAND TOTAL OF ORGANISATION, THE DEPTNO COLUMN IS NULL.
SQL> ED
Wrote file afiedt.buf

  1  SELECT NVL(TOO_CHAR(DEPTNO, 'ORGSAL'), SUM(SAL) DEPTSAL
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO)
  4* ORDER BY DEPTNO
SQL> /
SELECT NVL(TOO_CHAR(DEPTNO, 'ORGSAL'), SUM(SAL) DEPTSAL
                                                *
ERROR at line 1:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT NVL(TO_CHAR(DEPTNO), 'ORGSAL'), SUM(SAL) DEPTSAL
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO)
  4* ORDER BY DEPTNO
SQL> /

NVL(TO_CHAR(DEPTNO),'ORGSAL')               DEPTSAL                                                                     
---------------------------------------- ----------                                                                     
10                                             8750                                                                     
20                                            10875                                                                     
30                                             9400                                                                     
ORGSAL                                        29025                                                                     


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |     3 |    21 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |     3 |    21 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |    98 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT JOB, SUM(SAL) SUMOFSAL
  2  FROM EMP
  3  GROUP BY ROLLUP(JOB)
  4* ORDER BY JOB
SQL> /

JOB         SUMOFSAL                                                                                                    
--------- ----------                                                                                                    
ANALYST         6000                                                                                                    
CLERK           4150                                                                                                    
MANAGER         8275                                                                                                    
PRESIDENT       5000                                                                                                    
SALESMAN        5600                                                                                                    
               29025                                                                                                    

6 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |   168 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT JOB, SUM(SAL) SUMOFSAL, AVG(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(JOB)
  4* ORDER BY JOB
SQL> /

JOB         SUMOFSAL   AVG(SAL)                                                                                         
--------- ---------- ----------                                                                                         
ANALYST         6000       3000                                                                                         
CLERK           4150     1037.5                                                                                         
MANAGER         8275 2758.33333                                                                                         
PRESIDENT       5000       5000                                                                                         
SALESMAN        5600       1400                                                                                         
               29025 2073.21429                                                                                         

6 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |   168 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT JOB, TO_CHAR(SUM(SAL), '99G999D99') SUMOFSAL, TO_CHAR(AVG(SAL), '99G999D99') AVGOFSAL
  2  FROM EMP
  3  GROUP BY ROLLUP(JOB)
  4* ORDER BY JOB
SQL> /

JOB       SUMOFSAL   AVGOFSAL                                                                                           
--------- ---------- ----------                                                                                         
ANALYST     6,000.00   3,000.00                                                                                         
CLERK       4,150.00   1,037.50                                                                                         
MANAGER     8,275.00   2,758.33                                                                                         
PRESIDENT   5,000.00   5,000.00                                                                                         
SALESMAN    5,600.00   1,400.00                                                                                         
           29,025.00   2,073.21                                                                                         

6 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |   168 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> --WE CAN GIVE ALL GROUP FUNCTIONS
SQL> ED
Wrote file afiedt.buf

  1  SELECT JOB, TO_CHAR(SUM(SAL), '99G999D99') SUMOFSAL, TO_CHAR(AVG(SAL), '99G999D99') AVGOFSAL, TO_CHAR(MIN(SAL), '99G999D99') MINOFSAL, TO_CHAR(MAX(SAL), '99G999D99') MAXOFSAL
  2  FROM EMP
  3  GROUP BY ROLLUP(JOB)
  4* ORDER BY JOB
SQL> /

JOB       SUMOFSAL   AVGOFSAL   MINOFSAL   MAXOFSAL                                                                     
--------- ---------- ---------- ---------- ----------                                                                   
ANALYST     6,000.00   3,000.00   3,000.00   3,000.00                                                                   
CLERK       4,150.00   1,037.50     800.00   1,300.00                                                                   
MANAGER     8,275.00   2,758.33   2,450.00   2,975.00                                                                   
PRESIDENT   5,000.00   5,000.00   5,000.00   5,000.00                                                                   
SALESMAN    5,600.00   1,400.00   1,250.00   1,600.00                                                                   
           29,025.00   2,073.21     800.00   5,000.00                                                                   

6 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |   168 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT JOB, TO_CHAR(SUM(SAL), '99G999D99') SUMOFSAL, COUNT(JOB), TO_CHAR(AVG(SAL), '99G999D99') AVGOFSAL, TO_CHAR(MIN(SAL), '99G999D99') MINOFSAL, TO_CHAR(MAX(SAL), '99G999D99') MAXOFSAL
  2  FROM EMP
  3  GROUP BY ROLLUP(JOB)
  4* ORDER BY JOB
SQL> /

JOB       SUMOFSAL   COUNT(JOB) AVGOFSAL   MINOFSAL   MAXOFSAL                                                          
--------- ---------- ---------- ---------- ---------- ----------                                                        
ANALYST     6,000.00          2   3,000.00   3,000.00   3,000.00                                                        
CLERK       4,150.00          4   1,037.50     800.00   1,300.00                                                        
MANAGER     8,275.00          3   2,758.33   2,450.00   2,975.00                                                        
PRESIDENT   5,000.00          1   5,000.00   5,000.00   5,000.00                                                        
SALESMAN    5,600.00          4   1,400.00   1,250.00   1,600.00                                                        
           29,025.00         14   2,073.21     800.00   5,000.00                                                        

6 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |     5 |    60 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |   168 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4* ORDER BY JOB
SQL> /

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        20 ANALYST         6000                                                                                         
        20 CLERK           1900                                                                                         
        10 CLERK           1300                                                                                         
        30 CLERK            950                                                                                         
        10 MANAGER         2450                                                                                         
        20 MANAGER         2975                                                                                         
        30 MANAGER         2850                                                                                         
        10 PRESIDENT       5000                                                                                         
        30 SALESMAN        5600                                                                                         
        20                10875                                                                                         
        30                 9400                                                                                         

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
                          29025                                                                                         
        10                 8750                                                                                         

13 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 1419477654                                                                                             
                                                                                                                        
------------------------------------------------------------------------------                                          
| Id  | Operation             | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                          
------------------------------------------------------------------------------                                          
|   0 | SELECT STATEMENT      |      |    11 |   165 |     5  (40)| 00:00:01 |                                          
|   1 |  SORT ORDER BY        |      |    11 |   165 |     5  (40)| 00:00:01 |                                          
|   2 |   SORT GROUP BY ROLLUP|      |    11 |   165 |     5  (40)| 00:00:01 |                                          
|   3 |    TABLE ACCESS FULL  | EMP  |    14 |   210 |     3   (0)| 00:00:01 |                                          
------------------------------------------------------------------------------                                          

SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4* ORDER BY DEPTNO
  5  /

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        10 CLERK           1300                                                                                         
        10 MANAGER         2450                                                                                         
        10 PRESIDENT       5000                                                                                         
        10                 8750                                                                                         
        20 ANALYST         6000                                                                                         
        20 CLERK           1900                                                                                         
        20 MANAGER         2975                                                                                         
        20                10875                                                                                         
        30 CLERK            950                                                                                         
        30 MANAGER         2850                                                                                         
        30 SALESMAN        5600                                                                                         

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        30                 9400                                                                                         
                          29025                                                                                         

13 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |    11 |   165 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |    11 |   165 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |   210 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> /ED
SP2-0042: unknown command "/ED" - rest of line ignored.
SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, NVL(JOB, 'ALL '||DEPTNO||'TH SALARY'), SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4* ORDER BY DEPTNO
SQL> /

    DEPTNO NVL(JOB,'ALL'||DEPTNO||'THSALARY')                      SUM(SAL)                                             
---------- ----------------------------------------------------- ----------                                             
        10 CLERK                                                       1300                                             
        10 MANAGER                                                     2450                                             
        10 PRESIDENT                                                   5000                                             
        10 ALL 10TH SALARY                                             8750                                             
        20 ANALYST                                                     6000                                             
        20 CLERK                                                       1900                                             
        20 MANAGER                                                     2975                                             
        20 ALL 20TH SALARY                                            10875                                             
        30 CLERK                                                        950                                             
        30 MANAGER                                                     2850                                             
        30 SALESMAN                                                    5600                                             

    DEPTNO NVL(JOB,'ALL'||DEPTNO||'THSALARY')                      SUM(SAL)                                             
---------- ----------------------------------------------------- ----------                                             
        30 ALL 30TH SALARY                                             9400                                             
           ALL TH SALARY                                              29025                                             

13 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |    11 |   165 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |    11 |   165 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |   210 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, NVL(JOB, 'ALL '||DEPTNO||'TH DEPT SALARY'), SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4* ORDER BY DEPTNO
SQL> /

    DEPTNO NVL(JOB,'ALL'||DEPTNO||'THDEPTSALARY')                       SUM(SAL)                                        
---------- ---------------------------------------------------------- ----------                                        
        10 CLERK                                                            1300                                        
        10 MANAGER                                                          2450                                        
        10 PRESIDENT                                                        5000                                        
        10 ALL 10TH DEPT SALARY                                             8750                                        
        20 ANALYST                                                          6000                                        
        20 CLERK                                                            1900                                        
        20 MANAGER                                                          2975                                        
        20 ALL 20TH DEPT SALARY                                            10875                                        
        30 CLERK                                                             950                                        
        30 MANAGER                                                          2850                                        
        30 SALESMAN                                                         5600                                        

    DEPTNO NVL(JOB,'ALL'||DEPTNO||'THDEPTSALARY')                       SUM(SAL)                                        
---------- ---------------------------------------------------------- ----------                                        
        30 ALL 30TH DEPT SALARY                                             9400                                        
           ALL TH DEPT SALARY                                              29025                                        

13 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |    11 |   165 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |    11 |   165 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |   210 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT NVL(TO_CHAR(DEPTNO), 'ALL DEPARTMENTS'), NVL(JOB, 'ALL JOBS') JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4* ORDER BY DEPTNO
SQL> /

NVL(TO_CHAR(DEPTNO),'ALLDEPARTMENTS')    JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
10                                       CLERK           1300                                                           
10                                       MANAGER         2450                                                           
10                                       PRESIDENT       5000                                                           
10                                       ALL JOBS        8750                                                           
20                                       ANALYST         6000                                                           
20                                       CLERK           1900                                                           
20                                       MANAGER         2975                                                           
20                                       ALL JOBS       10875                                                           
30                                       CLERK            950                                                           
30                                       MANAGER         2850                                                           
30                                       SALESMAN        5600                                                           

NVL(TO_CHAR(DEPTNO),'ALLDEPARTMENTS')    JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
30                                       ALL JOBS        9400                                                           
ALL DEPARTMENTS                          ALL JOBS       29025                                                           

13 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 52302870                                                                                               
                                                                                                                        
-----------------------------------------------------------------------------                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                           
-----------------------------------------------------------------------------                                           
|   0 | SELECT STATEMENT     |      |    11 |   165 |     4  (25)| 00:00:01 |                                           
|   1 |  SORT GROUP BY ROLLUP|      |    11 |   165 |     4  (25)| 00:00:01 |                                           
|   2 |   TABLE ACCESS FULL  | EMP  |    14 |   210 |     3   (0)| 00:00:01 |                                           
-----------------------------------------------------------------------------                                           

SQL> ED
Wrote file afiedt.buf

  1  SELECT NVL(TO_CHAR(DEPTNO), 'ALL DEPARTMENTS') DEPTNO, NVL(JOB, 'ALL JOBS') JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4* ORDER BY DEPTNO
SQL> /

DEPTNO                                   JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
10                                       MANAGER         2450                                                           
10                                       CLERK           1300                                                           
10                                       PRESIDENT       5000                                                           
10                                       ALL JOBS        8750                                                           
20                                       ANALYST         6000                                                           
20                                       CLERK           1900                                                           
20                                       MANAGER         2975                                                           
20                                       ALL JOBS       10875                                                           
30                                       CLERK            950                                                           
30                                       MANAGER         2850                                                           
30                                       SALESMAN        5600                                                           

DEPTNO                                   JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
30                                       ALL JOBS        9400                                                           
ALL DEPARTMENTS                          ALL JOBS       29025                                                           

13 rows selected.


Execution Plan
----------------------------------------------------------                                                              
Plan hash value: 1419477654                                                                                             
                                                                                                                        
------------------------------------------------------------------------------                                          
| Id  | Operation             | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                          
------------------------------------------------------------------------------                                          
|   0 | SELECT STATEMENT      |      |    11 |   165 |     5  (40)| 00:00:01 |                                          
|   1 |  SORT ORDER BY        |      |    11 |   165 |     5  (40)| 00:00:01 |                                          
|   2 |   SORT GROUP BY ROLLUP|      |    11 |   165 |     5  (40)| 00:00:01 |                                          
|   3 |    TABLE ACCESS FULL  | EMP  |    14 |   210 |     3   (0)| 00:00:01 |                                          
------------------------------------------------------------------------------                                          

SQL> SET AUTOTRACE OFF
SQL> /

DEPTNO                                   JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
10                                       MANAGER         2450                                                           
10                                       CLERK           1300                                                           
10                                       PRESIDENT       5000                                                           
10                                       ALL JOBS        8750                                                           
20                                       ANALYST         6000                                                           
20                                       CLERK           1900                                                           
20                                       MANAGER         2975                                                           
20                                       ALL JOBS       10875                                                           
30                                       CLERK            950                                                           
30                                       MANAGER         2850                                                           
30                                       SALESMAN        5600                                                           

DEPTNO                                   JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
30                                       ALL JOBS        9400                                                           
ALL DEPARTMENTS                          ALL JOBS       29025                                                           

13 rows selected.

SQL> SELECT TO_CHAR(HIREDATE, 'YYYY') HIREDATE, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(HIREDATE);

HIRE   SUM(SAL)                                                                                                         
---- ----------                                                                                                         
1980        800                                                                                                         
1981       1600                                                                                                         
1981       1250                                                                                                         
1981       2975                                                                                                         
1981       2850                                                                                                         
1981       2450                                                                                                         
1981       1500                                                                                                         
1981       1250                                                                                                         
1981       5000                                                                                                         
1981       3950                                                                                                         
1982       1300                                                                                                         

HIRE   SUM(SAL)                                                                                                         
---- ----------                                                                                                         
1987       3000                                                                                                         
1987       1100                                                                                                         
          29025                                                                                                         

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT TO_CHAR(HIREDATE, 'YYYY') HIREDATE, SUM(SAL)
  2  FROM EMP
  3* GROUP BY ROLLUP(TO_CHAR(HIREDATE, 'YYYY'))
SQL> /

HIRE   SUM(SAL)                                                                                                         
---- ----------                                                                                                         
1980        800                                                                                                         
1981      22825                                                                                                         
1982       1300                                                                                                         
1987       4100                                                                                                         
          29025                                                                                                         

SQL> SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB);

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        10 CLERK           1300                                                                                         
        10 MANAGER         2450                                                                                         
        10 PRESIDENT       5000                                                                                         
        10                 8750                                                                                         
        20 CLERK           1900                                                                                         
        20 ANALYST         6000                                                                                         
        20 MANAGER         2975                                                                                         
        20                10875                                                                                         
        30 CLERK            950                                                                                         
        30 MANAGER         2850                                                                                         
        30 SALESMAN        5600                                                                                         

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        30                 9400                                                                                         
                          29025                                                                                         

13 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3* GROUP BY CUBE(DEPTNO, JOB)
SQL> /

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
                          29025                                                                                         
           CLERK           4150                                                                                         
           ANALYST         6000                                                                                         
           MANAGER         8275                                                                                         
           SALESMAN        5600                                                                                         
           PRESIDENT       5000                                                                                         
        10                 8750                                                                                         
        10 CLERK           1300                                                                                         
        10 MANAGER         2450                                                                                         
        10 PRESIDENT       5000                                                                                         
        20                10875                                                                                         

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        20 CLERK           1900                                                                                         
        20 ANALYST         6000                                                                                         
        20 MANAGER         2975                                                                                         
        30                 9400                                                                                         
        30 CLERK            950                                                                                         
        30 MANAGER         2850                                                                                         
        30 SALESMAN        5600                                                                                         

18 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY CUBE(DEPTNO, JOB)
  4* ORDER BY DEPTNO
SQL> /

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        10 CLERK           1300                                                                                         
        10 MANAGER         2450                                                                                         
        10 PRESIDENT       5000                                                                                         
        10                 8750                                                                                         
        20 ANALYST         6000                                                                                         
        20 CLERK           1900                                                                                         
        20 MANAGER         2975                                                                                         
        20                10875                                                                                         
        30 CLERK            950                                                                                         
        30 MANAGER         2850                                                                                         
        30 SALESMAN        5600                                                                                         

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        30                 9400                                                                                         
           ANALYST         6000                                                                                         
           CLERK           4150                                                                                         
           MANAGER         8275                                                                                         
           PRESIDENT       5000                                                                                         
           SALESMAN        5600                                                                                         
                          29025                                                                                         

18 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT NVL(DEPTNO, 'ALL DEPARTMENTS') DEPTNO, NVL(JOB, 'ALL JOBS'), SUM(SAL)
  2  FROM EMP
  3  GROUP BY CUBE(DEPTNO, JOB)
  4* ORDER BY DEPTNO
SQL> /
SELECT NVL(DEPTNO, 'ALL DEPARTMENTS') DEPTNO, NVL(JOB, 'ALL JOBS'), SUM(SAL)
                   *
ERROR at line 1:
ORA-01722: invalid number 


SQL> ED
Wrote file afiedt.buf

  1  SELECT NVL(TO_CHAR(DEPTNO), 'ALL DEPARTMENTS') DEPTNO, NVL(JOB, 'ALL JOBS'), SUM(SAL)
  2  FROM EMP
  3  GROUP BY CUBE(DEPTNO, JOB)
  4* ORDER BY DEPTNO
SQL> /

DEPTNO                                   NVL(JOB,'   SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
10                                       PRESIDENT       5000                                                           
10                                       MANAGER         2450                                                           
10                                       ALL JOBS        8750                                                           
10                                       CLERK           1300                                                           
20                                       MANAGER         2975                                                           
20                                       ANALYST         6000                                                           
20                                       CLERK           1900                                                           
20                                       ALL JOBS       10875                                                           
30                                       MANAGER         2850                                                           
30                                       SALESMAN        5600                                                           
30                                       CLERK            950                                                           

DEPTNO                                   NVL(JOB,'   SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
30                                       ALL JOBS        9400                                                           
ALL DEPARTMENTS                          CLERK           4150                                                           
ALL DEPARTMENTS                          ALL JOBS       29025                                                           
ALL DEPARTMENTS                          ANALYST         6000                                                           
ALL DEPARTMENTS                          MANAGER         8275                                                           
ALL DEPARTMENTS                          SALESMAN        5600                                                           
ALL DEPARTMENTS                          PRESIDENT       5000                                                           

18 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT NVL(TO_CHAR(DEPTNO), 'ALL DEPARTMENTS') DEPTNO, NVL(JOB, 'ALL JOBS') JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY CUBE(DEPTNO, JOB)
  4* ORDER BY DEPTNO
SQL> /

DEPTNO                                   JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
10                                       PRESIDENT       5000                                                           
10                                       MANAGER         2450                                                           
10                                       ALL JOBS        8750                                                           
10                                       CLERK           1300                                                           
20                                       MANAGER         2975                                                           
20                                       ANALYST         6000                                                           
20                                       CLERK           1900                                                           
20                                       ALL JOBS       10875                                                           
30                                       MANAGER         2850                                                           
30                                       SALESMAN        5600                                                           
30                                       CLERK            950                                                           

DEPTNO                                   JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
30                                       ALL JOBS        9400                                                           
ALL DEPARTMENTS                          CLERK           4150                                                           
ALL DEPARTMENTS                          ALL JOBS       29025                                                           
ALL DEPARTMENTS                          ANALYST         6000                                                           
ALL DEPARTMENTS                          MANAGER         8275                                                           
ALL DEPARTMENTS                          SALESMAN        5600                                                           
ALL DEPARTMENTS                          PRESIDENT       5000                                                           

18 rows selected.

SQL> D
SP2-0042: unknown command "D" - rest of line ignored.
SQL> ED
Wrote file afiedt.buf

  1  SELECT NVL(TO_CHAR(DEPTNO), 'ALL DEPARTMENTS') DEPTNO, NVL(JOB, 'ALL JOBS') JOB, SUM(SAL)
  2  FROM EMP
  3* GROUP BY CUBE(DEPTNO, JOB)
SQL> /

DEPTNO                                   JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
ALL DEPARTMENTS                          ALL JOBS       29025                                                           
ALL DEPARTMENTS                          CLERK           4150                                                           
ALL DEPARTMENTS                          ANALYST         6000                                                           
ALL DEPARTMENTS                          MANAGER         8275                                                           
ALL DEPARTMENTS                          SALESMAN        5600                                                           
ALL DEPARTMENTS                          PRESIDENT       5000                                                           
10                                       ALL JOBS        8750                                                           
10                                       CLERK           1300                                                           
10                                       MANAGER         2450                                                           
10                                       PRESIDENT       5000                                                           
20                                       ALL JOBS       10875                                                           

DEPTNO                                   JOB         SUM(SAL)                                                           
---------------------------------------- --------- ----------                                                           
20                                       CLERK           1900                                                           
20                                       ANALYST         6000                                                           
20                                       MANAGER         2975                                                           
30                                       ALL JOBS        9400                                                           
30                                       CLERK            950                                                           
30                                       MANAGER         2850                                                           
30                                       SALESMAN        5600                                                           

18 rows selected.

SQL> SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB);

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        10 CLERK           1300                                                                                         
        10 MANAGER         2450                                                                                         
        10 PRESIDENT       5000                                                                                         
        10                 8750                                                                                         
        20 CLERK           1900                                                                                         
        20 ANALYST         6000                                                                                         
        20 MANAGER         2975                                                                                         
        20                10875                                                                                         
        30 CLERK            950                                                                                         
        30 MANAGER         2850                                                                                         
        30 SALESMAN        5600                                                                                         

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        30                 9400                                                                                         
                          29025                                                                                         

13 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT GROUPING(DEPTNO) GROUPINDEX, DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3* GROUP BY ROLLUP(DEPTNO, JOB)
SQL> /

GROUPINDEX     DEPTNO JOB         SUM(SAL)                                                                              
---------- ---------- --------- ----------                                                                              
         0         10 CLERK           1300                                                                              
         0         10 MANAGER         2450                                                                              
         0         10 PRESIDENT       5000                                                                              
         0         10                 8750                                                                              
         0         20 CLERK           1900                                                                              
         0         20 ANALYST         6000                                                                              
         0         20 MANAGER         2975                                                                              
         0         20                10875                                                                              
         0         30 CLERK            950                                                                              
         0         30 MANAGER         2850                                                                              
         0         30 SALESMAN        5600                                                                              

GROUPINDEX     DEPTNO JOB         SUM(SAL)                                                                              
---------- ---------- --------- ----------                                                                              
         0         30                 9400                                                                              
         1                           29025                                                                              

13 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT GROUPING(DEPTNO) GROUPDEPTINDEX, DEPTNO, GROUPING(JOB) GROUPJOBINDEX, SUM(SAL)
  2  FROM EMP
  3* GROUP BY ROLLUP(DEPTNO, JOB)
SQL> /

GROUPDEPTINDEX     DEPTNO GROUPJOBINDEX   SUM(SAL)                                                                      
-------------- ---------- ------------- ----------                                                                      
             0         10             0       1300                                                                      
             0         10             0       2450                                                                      
             0         10             0       5000                                                                      
             0         10             1       8750                                                                      
             0         20             0       1900                                                                      
             0         20             0       6000                                                                      
             0         20             0       2975                                                                      
             0         20             1      10875                                                                      
             0         30             0        950                                                                      
             0         30             0       2850                                                                      
             0         30             0       5600                                                                      

GROUPDEPTINDEX     DEPTNO GROUPJOBINDEX   SUM(SAL)                                                                      
-------------- ---------- ------------- ----------                                                                      
             0         30             1       9400                                                                      
             1                        1      29025                                                                      

13 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT GROUPING(DEPTNO) GROUPDEPTINDEX, DEPTNO, GROUPING(JOB) GROUPJOBINDEX, JOB, SUM(SAL)
  2  FROM EMP
  3* GROUP BY ROLLUP(DEPTNO, JOB)
SQL> /

GROUPDEPTINDEX     DEPTNO GROUPJOBINDEX JOB         SUM(SAL)                                                            
-------------- ---------- ------------- --------- ----------                                                            
             0         10             0 CLERK           1300                                                            
             0         10             0 MANAGER         2450                                                            
             0         10             0 PRESIDENT       5000                                                            
             0         10             1                 8750                                                            
             0         20             0 CLERK           1900                                                            
             0         20             0 ANALYST         6000                                                            
             0         20             0 MANAGER         2975                                                            
             0         20             1                10875                                                            
             0         30             0 CLERK            950                                                            
             0         30             0 MANAGER         2850                                                            
             0         30             0 SALESMAN        5600                                                            

GROUPDEPTINDEX     DEPTNO GROUPJOBINDEX JOB         SUM(SAL)                                                            
-------------- ---------- ------------- --------- ----------                                                            
             0         30             1                 9400                                                            
             1                        1                29025                                                            

13 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT GROUPING(DEPTNO) GROUPDEPTINDEX, DEPTNO, GROUPING(JOB) GROUPJOBINDEX, JOB, SUM(SAL)
  2  FROM EMP
  3* GROUP BY ROLLUP(DEPTNO, JOB)
SQL> 
SQL> 
SQL> 
SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4* HAVING BY GROUPING(DEPTNO)=0
SQL> /
HAVING BY GROUPING(DEPTNO)=0
       *
ERROR at line 4:
ORA-00936: missing expression 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO)
  4* HAVING BY GROUPING(DEPTNO)=0
SQL> /
HAVING BY GROUPING(DEPTNO)=0
       *
ERROR at line 4:
ORA-00936: missing expression 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO)
  4* HAVING BY GROUPING(DEPTNO) 0
SQL> /
HAVING BY GROUPING(DEPTNO) 0
       *
ERROR at line 4:
ORA-00936: missing expression 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO)
  4* HAVING BY GROUPING(DEPTNO) &GRPINDEX
SQL> /
Enter value for grpindex: 0
old   4: HAVING BY GROUPING(DEPTNO) &GRPINDEX
new   4: HAVING BY GROUPING(DEPTNO) 0
HAVING BY GROUPING(DEPTNO) 0
       *
ERROR at line 4:
ORA-00936: missing expression 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO)
  4* HAVING BY GROUPING(DEPTNO) &GRPINDEX
SQL> /
Enter value for grpindex: =0
old   4: HAVING BY GROUPING(DEPTNO) &GRPINDEX
new   4: HAVING BY GROUPING(DEPTNO) =0
HAVING BY GROUPING(DEPTNO) =0
       *
ERROR at line 4:
ORA-00936: missing expression 


SQL> /
Enter value for grpindex: =0;
old   4: HAVING BY GROUPING(DEPTNO) &GRPINDEX
new   4: HAVING BY GROUPING(DEPTNO) =0;
HAVING BY GROUPING(DEPTNO) =0;
       *
ERROR at line 4:
ORA-00936: missing expression 


SQL> SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4  HAVING GROUPING(DEPTNO) = 0;

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        10 CLERK           1300                                                                                         
        10 MANAGER         2450                                                                                         
        10 PRESIDENT       5000                                                                                         
        10                 8750                                                                                         
        20 CLERK           1900                                                                                         
        20 ANALYST         6000                                                                                         
        20 MANAGER         2975                                                                                         
        20                10875                                                                                         
        30 CLERK            950                                                                                         
        30 MANAGER         2850                                                                                         
        30 SALESMAN        5600                                                                                         

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        30                 9400                                                                                         

12 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4* HAVING GROUPING(DEPTNO) &GRPINDEX
SQL> /
Enter value for grpindex: =0
old   4: HAVING GROUPING(DEPTNO) &GRPINDEX
new   4: HAVING GROUPING(DEPTNO) =0

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        10 CLERK           1300                                                                                         
        10 MANAGER         2450                                                                                         
        10 PRESIDENT       5000                                                                                         
        10                 8750                                                                                         
        20 CLERK           1900                                                                                         
        20 ANALYST         6000                                                                                         
        20 MANAGER         2975                                                                                         
        20                10875                                                                                         
        30 CLERK            950                                                                                         
        30 MANAGER         2850                                                                                         
        30 SALESMAN        5600                                                                                         

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        30                 9400                                                                                         

12 rows selected.

SQL> /
Enter value for grpindex: =1
old   4: HAVING GROUPING(DEPTNO) &GRPINDEX
new   4: HAVING GROUPING(DEPTNO) =1

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
                          29025                                                                                         

SQL> R
  1  SELECT DEPTNO, JOB, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO, JOB)
  4* HAVING GROUPING(DEPTNO) &GRPINDEX
Enter value for grpindex: IN(0,1)
old   4: HAVING GROUPING(DEPTNO) &GRPINDEX
new   4: HAVING GROUPING(DEPTNO) IN(0,1)

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        10 CLERK           1300                                                                                         
        10 MANAGER         2450                                                                                         
        10 PRESIDENT       5000                                                                                         
        10                 8750                                                                                         
        20 CLERK           1900                                                                                         
        20 ANALYST         6000                                                                                         
        20 MANAGER         2975                                                                                         
        20                10875                                                                                         
        30 CLERK            950                                                                                         
        30 MANAGER         2850                                                                                         
        30 SALESMAN        5600                                                                                         

    DEPTNO JOB         SUM(SAL)                                                                                         
---------- --------- ----------                                                                                         
        30                 9400                                                                                         
                          29025                                                                                         

13 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT &DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&DIM)
  4* HAVING GROUPING(&DIM) &GRPINDEX
SQL> /
Enter value for dim: DEPTNO
old   1: SELECT &DIM, SUM(SAL)
new   1: SELECT DEPTNO, SUM(SAL)
Enter value for dim: DEPTNO
old   3: GROUP BY ROLLUP(&DIM)
new   3: GROUP BY ROLLUP(DEPTNO)
Enter value for dim: DEPTNO
Enter value for grpindex: 0
old   4: HAVING GROUPING(&DIM) &GRPINDEX
new   4: HAVING GROUPING(DEPTNO) 0
HAVING GROUPING(DEPTNO) 0
                        *
ERROR at line 4:
ORA-00920: invalid relational operator 


SQL> SELECT DEPTNO, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(DEPTNO)
  4  HAVING GROUPING(DEPTNO)=0;

    DEPTNO   SUM(SAL)                                                                                                   
---------- ----------                                                                                                   
        30       9400                                                                                                   
        20      10875                                                                                                   
        10       8750                                                                                                   

SQL> ED
Wrote file afiedt.buf

  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM)=0
SQL> /
Enter value for dim: DEPTNO
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT DEPTNO, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(DEPTNO)
old   4: HAVING GROUPING(&&DIM)=0
new   4: HAVING GROUPING(DEPTNO)=0

    DEPTNO   SUM(SAL)                                                                                                   
---------- ----------                                                                                                   
        30       9400                                                                                                   
        20      10875                                                                                                   
        10       8750                                                                                                   

SQL> ED
Wrote file afiedt.buf

  1  SELECT &DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&DIM)
  4* HAVING GROUPING(&DIM)=0
SQL> /
old   1: SELECT &DIM, SUM(SAL)
new   1: SELECT DEPTNO, SUM(SAL)
old   3: GROUP BY ROLLUP(&DIM)
new   3: GROUP BY ROLLUP(DEPTNO)
old   4: HAVING GROUPING(&DIM)=0
new   4: HAVING GROUPING(DEPTNO)=0

    DEPTNO   SUM(SAL)                                                                                                   
---------- ----------                                                                                                   
        30       9400                                                                                                   
        20      10875                                                                                                   
        10       8750                                                                                                   

SQL> ED
Wrote file afiedt.buf

  1  SELECT &DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&DIM)
  4* HAVING GROUPING(&DIM)=0
SQL> 
SQL> 
SQL> ED
Wrote file afiedt.buf

  1  SELECT &DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&DIM)
  4* HAVING GROUPING(&DIM) &GRPINDEX
SQL> /
old   1: SELECT &DIM, SUM(SAL)
new   1: SELECT DEPTNO, SUM(SAL)
old   3: GROUP BY ROLLUP(&DIM)
new   3: GROUP BY ROLLUP(DEPTNO)
Enter value for grpindex: 1
old   4: HAVING GROUPING(&DIM) &GRPINDEX
new   4: HAVING GROUPING(DEPTNO) 1
HAVING GROUPING(DEPTNO) 1
                        *
ERROR at line 4:
ORA-00920: invalid relational operator 


SQL> /
old   1: SELECT &DIM, SUM(SAL)
new   1: SELECT DEPTNO, SUM(SAL)
old   3: GROUP BY ROLLUP(&DIM)
new   3: GROUP BY ROLLUP(DEPTNO)
Enter value for grpindex: =1
old   4: HAVING GROUPING(&DIM) &GRPINDEX
new   4: HAVING GROUPING(DEPTNO) =1

    DEPTNO   SUM(SAL)                                                                                                   
---------- ----------                                                                                                   
                29025                                                                                                   

SQL> ED
Wrote file afiedt.buf

  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
SQL> /
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT DEPTNO, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(DEPTNO)
Enter value for grpindex: IN(0,1)
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(DEPTNO) IN(0,1)

    DEPTNO   SUM(SAL)                                                                                                   
---------- ----------                                                                                                   
        10       8750                                                                                                   
        20      10875                                                                                                   
        30       9400                                                                                                   
                29025                                                                                                   

SQL> DEFINE DIM=JOB
SQL> R
  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT JOB, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(JOB)
Enter value for grpindex: 0
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(JOB) 0
HAVING GROUPING(JOB) 0
                     *
ERROR at line 4:
ORA-00920: invalid relational operator 


SQL> /
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT JOB, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(JOB)
Enter value for grpindex: =0
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(JOB) =0

JOB         SUM(SAL)                                                                                                    
--------- ----------                                                                                                    
CLERK           4150                                                                                                    
SALESMAN        5600                                                                                                    
PRESIDENT       5000                                                                                                    
MANAGER         8275                                                                                                    
ANALYST         6000                                                                                                    

SQL> R
  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT JOB, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(JOB)
Enter value for grpindex: =1
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(JOB) =1

JOB         SUM(SAL)                                                                                                    
--------- ----------                                                                                                    
               29025                                                                                                    

SQL> /
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT JOB, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(JOB)
Enter value for grpindex: IN(0,1)
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(JOB) IN(0,1)

JOB         SUM(SAL)                                                                                                    
--------- ----------                                                                                                    
ANALYST         6000                                                                                                    
CLERK           4150                                                                                                    
MANAGER         8275                                                                                                    
PRESIDENT       5000                                                                                                    
SALESMAN        5600                                                                                                    
               29025                                                                                                    

6 rows selected.

SQL> DEFINE DIM=TO_CHAR(HIREDATE, 'YYYY')
SQL> R
  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT TO_CHAR(HIREDATE,, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(TO_CHAR(HIREDATE,)
Enter value for grpindex: =0
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(TO_CHAR(HIREDATE,) =0
SELECT TO_CHAR(HIREDATE,, SUM(SAL)
                        *
ERROR at line 1:
ORA-00936: missing expression 


SQL> /
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT TO_CHAR(HIREDATE,, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(TO_CHAR(HIREDATE,)
Enter value for grpindex: IN(0,1)
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(TO_CHAR(HIREDATE,) IN(0,1)
SELECT TO_CHAR(HIREDATE,, SUM(SAL)
                        *
ERROR at line 1:
ORA-00936: missing expression 


SQL> ED
Wrote file afiedt.buf

  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
SQL> /
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT TO_CHAR(HIREDATE,, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(TO_CHAR(HIREDATE,)
Enter value for grpindex: =1
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(TO_CHAR(HIREDATE,) =1
SELECT TO_CHAR(HIREDATE,, SUM(SAL)
                        *
ERROR at line 1:
ORA-00936: missing expression 


SQL> DEFINE DIM=JOB
SQL> R
  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT JOB, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(JOB)
Enter value for grpindex: =1
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(JOB) =1

JOB         SUM(SAL)                                                                                                    
--------- ----------                                                                                                    
               29025                                                                                                    

SQL> DEFINE DIM=TO_CHAR(HIREDATE, 'YYYY')
SQL> R
  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT TO_CHAR(HIREDATE,, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(TO_CHAR(HIREDATE,)
Enter value for grpindex: =1
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(TO_CHAR(HIREDATE,) =1
SELECT TO_CHAR(HIREDATE,, SUM(SAL)
                        *
ERROR at line 1:
ORA-00936: missing expression 


SQL> CL SCR

SQL> ED
Wrote file afiedt.buf

  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
SQL> /
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT TO_CHAR(HIREDATE,, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(TO_CHAR(HIREDATE,)
Enter value for grpindex: =0
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(TO_CHAR(HIREDATE,) =0
SELECT TO_CHAR(HIREDATE,, SUM(SAL)
                        *
ERROR at line 1:
ORA-00936: missing expression 


SQL> DEFINE DIM=TO_CHAR(HIREDATE, 'YYYY');
SQL> R
  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT TO_CHAR(HIREDATE,, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(TO_CHAR(HIREDATE,)
Enter value for grpindex: 
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(TO_CHAR(HIREDATE,) 
SELECT TO_CHAR(HIREDATE,, SUM(SAL)
                        *
ERROR at line 1:
ORA-00936: missing expression 


SQL> 
SQL> DEFINE DIM=TO_CHAR(HIREDATE, 'YY')
SQL> R
  1  SELECT &&DIM, SUM(SAL)
  2  FROM EMP
  3  GROUP BY ROLLUP(&&DIM)
  4* HAVING GROUPING(&&DIM) &GRPINDEX
old   1: SELECT &&DIM, SUM(SAL)
new   1: SELECT TO_CHAR(HIREDATE,, SUM(SAL)
old   3: GROUP BY ROLLUP(&&DIM)
new   3: GROUP BY ROLLUP(TO_CHAR(HIREDATE,)
Enter value for grpindex: 
old   4: HAVING GROUPING(&&DIM) &GRPINDEX
new   4: HAVING GROUPING(TO_CHAR(HIREDATE,) 
SELECT TO_CHAR(HIREDATE,, SUM(SAL)
                        *
ERROR at line 1:
ORA-00936: missing expression 


SQL> SELECT * FROM DEPT;

    DEPTNO DNAME          LOC                                                                                           
---------- -------------- -------------                                                                                 
        10 ACCOUNTING     NEW YORK                                                                                      
        20 RESEARCH       DALLAS                                                                                        
        30 SALES          CHICAGO                                                                                       
        40 OPERATIONS     BOSTON                                                                                        

SQL> SELECT * FROM EMP;

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO                                   
---------- ---------- --------- ---------- --------- ---------- ---------- ----------                                   
      7369 SMITH      CLERK           7902 17-DEC-80        800                    20                                   
      7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300         30                                   
      7521 WARD       SALESMAN        7698 22-FEB-81       1250        500         30                                   
      7566 JONES      MANAGER         7839 02-APR-81       2975                    20                                   
      7654 MARTIN     SALESMAN        7698 28-SEP-81       1250       1400         30                                   
      7698 BLAKE      MANAGER         7839 01-MAY-81       2850                    30                                   
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10                                   
      7788 SCOTT      ANALYST         7566 19-APR-87       3000                    20                                   
      7839 KING       PRESIDENT            17-NOV-81       5000                    10                                   
      7844 TURNER     SALESMAN        7698 08-SEP-81       1500          0         30                                   
      7876 ADAMS      CLERK           7788 23-MAY-87       1100                    20                                   

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO                                   
---------- ---------- --------- ---------- --------- ---------- ---------- ----------                                   
      7900 JAMES      CLERK           7698 03-DEC-81        950                    30                                   
      7902 FORD       ANALYST         7566 03-DEC-81       3000                    20                                   
      7934 MILLER     CLERK           7782 23-JAN-82       1300                    10                                   

14 rows selected.

SQL> SELECT * FROM DEPT;

    DEPTNO DNAME          LOC                                                                                           
---------- -------------- -------------                                                                                 
        10 ACCOUNTING     NEW YORK                                                                                      
        20 RESEARCH       DALLAS                                                                                        
        30 SALES          CHICAGO                                                                                       
        40 OPERATIONS     BOSTON                                                                                        

SQL> SELECT EMPNO, ENAME, JOB, DEPTNO FROM EMP;

     EMPNO ENAME      JOB           DEPTNO                                                                              
---------- ---------- --------- ----------                                                                              
      7369 SMITH      CLERK             20                                                                              
      7499 ALLEN      SALESMAN          30                                                                              
      7521 WARD       SALESMAN          30                                                                              
      7566 JONES      MANAGER           20                                                                              
      7654 MARTIN     SALESMAN          30                                                                              
      7698 BLAKE      MANAGER           30                                                                              
      7782 CLARK      MANAGER           10                                                                              
      7788 SCOTT      ANALYST           20                                                                              
      7839 KING       PRESIDENT         10                                                                              
      7844 TURNER     SALESMAN          30                                                                              
      7876 ADAMS      CLERK             20                                                                              

     EMPNO ENAME      JOB           DEPTNO                                                                              
---------- ---------- --------- ----------                                                                              
      7900 JAMES      CLERK             30                                                                              
      7902 FORD       ANALYST           20                                                                              
      7934 MILLER     CLERK             10                                                                              

14 rows selected.

SQL> --IF THE REQUIREMENT OF THE CLIENT IS TO GET THE DNAME OF THE EMPLOYEE WITHOUT USING DEPT TABLE. THEN WE HAVE FUNCTION CALLED DECODE.
SQL> ED
Wrote file afiedt.buf

  1  SELECT EMPNO, ENAME, JOB, DEPTNO,
  2  DECODE(
  3  	DEPTNO,
  4  	10, 'ACCOUNTING',
  5  	20, 'RESEARCH',
  6  	30, 'SALES',
  7  	40, 'OPERRATIONS',
  8  	'OTHER'
  9  	) DEPARTMENTS
 10  FROM EMP
 11* ORDER BY DEPARTMENTS
SQL> /

     EMPNO ENAME      JOB           DEPTNO DEPARTMENTS                                                                  
---------- ---------- --------- ---------- -----------                                                                  
      7782 CLARK      MANAGER           10 ACCOUNTING                                                                   
      7839 KING       PRESIDENT         10 ACCOUNTING                                                                   
      7934 MILLER     CLERK             10 ACCOUNTING                                                                   
      7566 JONES      MANAGER           20 RESEARCH                                                                     
      7902 FORD       ANALYST           20 RESEARCH                                                                     
      7876 ADAMS      CLERK             20 RESEARCH                                                                     
      7369 SMITH      CLERK             20 RESEARCH                                                                     
      7788 SCOTT      ANALYST           20 RESEARCH                                                                     
      7521 WARD       SALESMAN          30 SALES                                                                        
      7844 TURNER     SALESMAN          30 SALES                                                                        
      7499 ALLEN      SALESMAN          30 SALES                                                                        

     EMPNO ENAME      JOB           DEPTNO DEPARTMENTS                                                                  
---------- ---------- --------- ---------- -----------                                                                  
      7900 JAMES      CLERK             30 SALES                                                                        
      7698 BLAKE      MANAGER           30 SALES                                                                        
      7654 MARTIN     SALESMAN          30 SALES                                                                        

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT
  2  INITCAP(ENAME ||' TAKES CARE OF '||
  3  DECODE
  4  (
  5  JOB,
  6  'ANALYST', 'ANALYSIS',
  7  'CLERK', 'FILING',
  8  'MANAGER', 'MANAGING',
  9  'PRESIDENT', 'ADMINISTRATION',
 10  'SALESMAN', 'SALES'
 11  )
 12  RESPONSIBILITIES
 13* FROM EMP
SQL> /
RESPONSIBILITIES
*
ERROR at line 12:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT
  2  INITCAP(ENAME ||' TAKES CARE OF '||
  3  DECODE
  4  (
  5  JOB,
  6  'ANALYST', 'ANALYSIS',
  7  'CLERK', 'FILING',
  8  'MANAGER', 'MANAGING',
  9  'PRESIDENT', 'ADMINISTRATION',
 10  'SALESMAN', 'SALES'
 11  ) RESPONSIBILITIES
 12* FROM EMP
SQL> /
) RESPONSIBILITIES
  *
ERROR at line 11:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT
  2  INITCAP(ENAME) ||' TAKES CARE OF '||
  3  DECODE
  4  (
  5  JOB,
  6  'ANALYST', 'ANALYSIS',
  7  'CLERK', 'FILING',
  8  'MANAGER', 'MANAGING',
  9  'PRESIDENT', 'ADMINISTRATION',
 10  'SALESMAN', 'SALES'
 11  ) RESPONSIBILITIES
 12* FROM EMP
SQL> /

RESPONSIBILITIES                                                                                                        
---------------------------------------                                                                                 
Smith TAKES CARE OF FILING                                                                                              
Allen TAKES CARE OF SALES                                                                                               
Ward TAKES CARE OF SALES                                                                                                
Jones TAKES CARE OF MANAGING                                                                                            
Martin TAKES CARE OF SALES                                                                                              
Blake TAKES CARE OF MANAGING                                                                                            
Clark TAKES CARE OF MANAGING                                                                                            
Scott TAKES CARE OF ANALYSIS                                                                                            
King TAKES CARE OF ADMINISTRATION                                                                                       
Turner TAKES CARE OF SALES                                                                                              
Adams TAKES CARE OF FILING                                                                                              

RESPONSIBILITIES                                                                                                        
---------------------------------------                                                                                 
James TAKES CARE OF FILING                                                                                              
Ford TAKES CARE OF ANALYSIS                                                                                             
Miller TAKES CARE OF FILING                                                                                             

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT ENAME, JOB,
  2  DECODE
  3  (
  4  JOB,
  5  'CLERK', 'E',
  6  'SALESMAN', 'D',
  7  'ANALYST', 'C',
  8  'MANAGER', 'B',
  9  'PRESIDENT', 'A',
 10  'O'
 11  ) GRADES
 12* FROM EMP
SQL> /

ENAME      JOB       G                                                                                                  
---------- --------- -                                                                                                  
SMITH      CLERK     E                                                                                                  
ALLEN      SALESMAN  D                                                                                                  
WARD       SALESMAN  D                                                                                                  
JONES      MANAGER   B                                                                                                  
MARTIN     SALESMAN  D                                                                                                  
BLAKE      MANAGER   B                                                                                                  
CLARK      MANAGER   B                                                                                                  
SCOTT      ANALYST   C                                                                                                  
KING       PRESIDENT A                                                                                                  
TURNER     SALESMAN  D                                                                                                  
ADAMS      CLERK     E                                                                                                  

ENAME      JOB       G                                                                                                  
---------- --------- -                                                                                                  
JAMES      CLERK     E                                                                                                  
FORD       ANALYST   C                                                                                                  
MILLER     CLERK     E                                                                                                  

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT ENAME, JOB,
  2  DECODE
  3  (
  4  JOB,
  5  'CLERK', 'E',
  6  'SALESMAN', 'D',
  7  'ANALYST', 'C',
  8  'MANAGER', 'B',
  9  'PRESIDENT', 'A',
 10  'O'
 11  ) GRADES,
 12  DEPTNO,
 13  DECODE
 14  (
 15  DEPTNO,
 16  10, 'ACCOUNTING',
 17  20, 'RESEARCH',
 18  30, 'SALES',
 19  40, 'OPERATIONS',
 20  'OTHER'
 21  ) DEPARTMENTS,
 22  SAL, GRADE
 23  FROM EMP E, SALGRADE S
 24  WHERE SAL BETWEEN HISAL AND LOSAL
 25* ORDER BY JOB
SQL> /

no rows selected

SQL> ED
Wrote file afiedt.buf

  1  SELECT ENAME, JOB,
  2  DECODE
  3  (
  4  JOB,
  5  'CLERK', 'E',
  6  'SALESMAN', 'D',
  7  'ANALYST', 'C',
  8  'MANAGER', 'B',
  9  'PRESIDENT', 'A',
 10  'O'
 11  ) GRADES,
 12  DEPTNO,
 13  DECODE
 14  (
 15  DEPTNO,
 16  10, 'ACCOUNTING',
 17  20, 'RESEARCH',
 18  30, 'SALES',
 19  40, 'OPERATIONS',
 20  'OTHER'
 21  ) DEPARTMENTS,
 22  SAL, GRADE
 23  FROM EMP E, SALGRADE S
 24  WHERE SAL BETWEEN LOSAL AND HISAL
 25* ORDER BY JOB
SQL> /

ENAME      JOB       G     DEPTNO DEPARTMENT        SAL      GRADE                                                      
---------- --------- - ---------- ---------- ---------- ----------                                                      
FORD       ANALYST   C         20 RESEARCH         3000          4                                                      
SCOTT      ANALYST   C         20 RESEARCH         3000          4                                                      
JAMES      CLERK     E         30 SALES             950          1                                                      
ADAMS      CLERK     E         20 RESEARCH         1100          1                                                      
MILLER     CLERK     E         10 ACCOUNTING       1300          2                                                      
SMITH      CLERK     E         20 RESEARCH          800          1                                                      
CLARK      MANAGER   B         10 ACCOUNTING       2450          4                                                      
BLAKE      MANAGER   B         30 SALES            2850          4                                                      
JONES      MANAGER   B         20 RESEARCH         2975          4                                                      
KING       PRESIDENT A         10 ACCOUNTING       5000          5                                                      
ALLEN      SALESMAN  D         30 SALES            1600          3                                                      

ENAME      JOB       G     DEPTNO DEPARTMENT        SAL      GRADE                                                      
---------- --------- - ---------- ---------- ---------- ----------                                                      
MARTIN     SALESMAN  D         30 SALES            1250          2                                                      
WARD       SALESMAN  D         30 SALES            1250          2                                                      
TURNER     SALESMAN  D         30 SALES            1500          3                                                      

14 rows selected.

SQL> ED
Wrote file afiedt.buf

  1  SELECT ENAME, 
  2  DECODE
  3  (
  4  'MGR'
  5  7566, (SELECT ENAME FROM EMP WHERE EMPNO=7566),
  6  7698, (SELECT ENAME FROM EMP WHERE EMPNO=7698),
  7  7782, (SELECT ENAME FROM EMP WHERE EMPNO=7782),
  8  7788, (SELECT ENAME FROM EMP WHERE EMPNO=7788),
  9  7839, (SELECT ENAME FROM EMP WHERE EMPNO=7839),
 10  7902, (SELECT ENAME FROM EMP WHERE EMPNO=7902),
 11  'DO NOT KNOW'
 12  ) MANAGERS,
 13  JOB,
 14  DECODE
 15  (
 16  JOB,
 17  'CLERK', 'E',
 18  'SALESMAN', 'D',
 19  'ANALYST', 'C',
 20  'MANAGER', 'B',
 21  'PRESIDENT', 'A',
 22  'O'
 23  ) GRADES,
 24  DEPTNO,
 25  DECODE
 26  (
 27  DEPTNO,
 28  10, 'ACCOUNTING',
 29  20, 'RESEARCH',
 30  30, 'SALES',
 31  40, 'OPERATIONS',
 32  'OTHER'
 33  ) DEPARTMENTS,
 34  SAL, GRADE
 35  FROM EMP E, SALGRADE S
 36  WHERE SAL BETWEEN LOSAL AND HISAL
 37* ORDER BY JOB
SQL> /
7566, (SELECT ENAME FROM EMP WHERE EMPNO=7566),
*
ERROR at line 5:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT ENAME, 
  2  DECODE
  3  (
  4  MGR,
  5  7566, (SELECT ENAME FROM EMP WHERE EMPNO=7566),
  6  7698, (SELECT ENAME FROM EMP WHERE EMPNO=7698),
  7  7782, (SELECT ENAME FROM EMP WHERE EMPNO=7782),
  8  7788, (SELECT ENAME FROM EMP WHERE EMPNO=7788),
  9  7839, (SELECT ENAME FROM EMP WHERE EMPNO=7839),
 10  7902, (SELECT ENAME FROM EMP WHERE EMPNO=7902),
 11  'DO NOT KNOW'
 12  ) MANAGERS,
 13  JOB,
 14  DECODE
 15  (
 16  JOB,
 17  'CLERK', 'E',
 18  'SALESMAN', 'D',
 19  'ANALYST', 'C',
 20  'MANAGER', 'B',
 21  'PRESIDENT', 'A',
 22  'O'
 23  ) GRADES,
 24  DEPTNO,
 25  DECODE
 26  (
 27  DEPTNO,
 28  10, 'ACCOUNTING',
 29  20, 'RESEARCH',
 30  30, 'SALES',
 31  40, 'OPERATIONS',
 32  'OTHER'
 33  ) DEPARTMENTS,
 34  SAL, GRADE
 35  FROM EMP E, SALGRADE S
 36  WHERE SAL BETWEEN LOSAL AND HISAL
 37* ORDER BY JOB
SQL> /

ENAME      MANAGERS    JOB       G     DEPTNO DEPARTMENT        SAL      GRADE                                          
---------- ----------- --------- - ---------- ---------- ---------- ----------                                          
FORD       JONES       ANALYST   C         20 RESEARCH         3000          4                                          
SCOTT      JONES       ANALYST   C         20 RESEARCH         3000          4                                          
JAMES      BLAKE       CLERK     E         30 SALES             950          1                                          
ADAMS      SCOTT       CLERK     E         20 RESEARCH         1100          1                                          
MILLER     CLARK       CLERK     E         10 ACCOUNTING       1300          2                                          
SMITH      FORD        CLERK     E         20 RESEARCH          800          1                                          
CLARK      KING        MANAGER   B         10 ACCOUNTING       2450          4                                          
BLAKE      KING        MANAGER   B         30 SALES            2850          4                                          
JONES      KING        MANAGER   B         20 RESEARCH         2975          4                                          
KING       DO NOT KNOW PRESIDENT A         10 ACCOUNTING       5000          5                                          
ALLEN      BLAKE       SALESMAN  D         30 SALES            1600          3                                          

ENAME      MANAGERS    JOB       G     DEPTNO DEPARTMENT        SAL      GRADE                                          
---------- ----------- --------- - ---------- ---------- ---------- ----------                                          
MARTIN     BLAKE       SALESMAN  D         30 SALES            1250          2                                          
WARD       BLAKE       SALESMAN  D         30 SALES            1250          2                                          
TURNER     BLAKE       SALESMAN  D         30 SALES            1500          3                                          

14 rows selected.

SQL> SELECT TO_CHAR(HIREDATE, 'YYYY'), COUNT(*)
  2  FROM EMP
  3  GROUP BY ROLLUP(TO_CHAR(HIREDATE, 'YYYY');
GROUP BY ROLLUP(TO_CHAR(HIREDATE, 'YYYY')
                                        *
ERROR at line 3:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT TO_CHAR(HIREDATE, 'YYYY') HIREDATE, COUNT(*)
  2  FROM EMP
  3* GROUP BY ROLLUP(TO_CHAR(HIREDATE, 'YYYY'))
SQL> /

HIRE   COUNT(*)                                                                                                         
---- ----------                                                                                                         
1980          1                                                                                                         
1981         10                                                                                                         
1982          1                                                                                                         
1987          2                                                                                                         
             14                                                                                                         

SQL> SPOOL OFF
